C51 COMPILER V9.00   PRINT                                                                 06/12/2020 10:50:50 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE PRINT
OBJECT MODULE PLACED IN ..\obj\print.obj
COMPILER INVOKED BY: D:\Program Files\KEILC51\files\C51\BIN\C51.EXE ..\..\user\print.c BROWSE DEBUG OBJECTEXTEND PRINT(.
                    -\print.lst) TABS(2) OBJECT(..\obj\print.obj)

line level    source

   1          /**
   2            ******************************************************************************
   3            * @file    
   4            * @author  
   5            * @version 
   6            * @date   
   7            * @brief    
   8                        %d               十进制有符号整数
   9                        %u               十进制无符号整数
  10                        %f               浮点数
  11                        %s               字符串
  12                        %c               单个字符
  13                        %p               指针的值
  14                        %e               指数形式的浮点数
  15                        %x, %X           无符号以十六进制表示的整数
  16                        %0               无符号以八进制表示的整数
  17                        %g               自动选择合适的表示法
  18                        %lf              表示输出double浮点数
  19            ******************************************************************************  
  20            * 
  21            * 
  22            ******************************************************************************
  23            */
  24          /*-- includes ----------------------------------------------------------------*/
  25          #include "./print.h"
  26          
  27          
  28          /*-- defined -----------------------------------------------------------------*/
  29          #define      DB_LOG(x)             LOG("[PRINTF]");LOG(x)
  30          
  31          
  32          
  33          
  34          /*-- private variables -------------------------------------------------------*/
  35          static  bit    BIT_TMP;
  36          
  37          
  38          
  39          /*-- functions ---------------------------------------------------------------*/
  40          #if     LOG_ENABLE
  41          
  42          
  43          /**           
  44            * @brief      for UART_printf      
  45            * @param    
  46            * @return  
  47            * @note
  48            */
  49          char putchar (char c)
  50          {
  51   1        while (!TI);
  52   1        TI = 0;
  53   1        return (SBUF = c);
  54   1      }
C51 COMPILER V9.00   PRINT                                                                 06/12/2020 10:50:50 PAGE 2   

  55          
  56          
  57          /**           
  58            * @brief            
  59            * @param    
  60            * @return  
  61            * @note
  62            */
  63          static  void  mcu_uart0_timer1(u32_t u32Baudrate)   
  64          {
  65   1        clr_EA;
  66   1      
  67   1        P06_Quasi_Mode;   /* Setting UART pin as Quasi mode for transmit */
  68   1        P07_Quasi_Mode;   /* Setting UART pin as Quasi mode for transmit */
  69   1        
  70   1        SCON = 0x50;      /* UART0 Mode1,REN=1,TI=0 */
  71   1        TMOD |= 0x20;     /* Timer1 Mode1 */
  72   1          
  73   1        set_SMOD;         /* UART0 Double Rate Enable */
  74   1        set_T1M;
  75   1        clr_BRCK;         /* Serial port 0 baud rate clock source = Timer1 */
  76   1       
  77   1        TH1 = 256 - (1000000/u32Baudrate+1);          /*16 MHz */   
  78   1      
  79   1        clr_ET1;
  80   1        set_TR1;          /* Enable timer1. */
  81   1        
  82   1        set_TI;           /* For printf function must setting TI = 1 */
  83   1      
  84   1        set_ES;           /* Enable Uart interrupt. */
  85   1        set_EA;           /* Enable global interrupt */ 
  86   1      }
  87          
  88          
  89          /**           
  90            * @brief            
  91            * @param    
  92            * @return  
  93            * @note
  94            */
  95          void  uart0_interrupt_ISR(void)  interrupt  4
  96          {
  97   1        u8_t  dat = 0;  
  98   1      
  99   1        /* if reception occur */
 100   1        if(RI)
 101   1        {
 102   2          clr_RI; 
 103   2      
 104   2          dat = SBUF;
 105   2          if(dat == 0xAA)  P12 = !P12;
 106   2        }
 107   1      
 108   1         /* if transmit occur */
 109   1      #if  0     /* When use <stdio.h> printf function, this function must remove.  */
                if(TI)
                {
                  clr_TI; 
                }
              #endif
 115   1      }
 116          
C51 COMPILER V9.00   PRINT                                                                 06/12/2020 10:50:50 PAGE 3   

 117          
 118          #endif
 119          
 120          /**           
 121            * @brief            
 122            * @param    
 123            * @return  
 124            * @note
 125            */
 126          void  printf_task (void)  _task_   PRINT_TASK_PRIORITY
 127          {
 128   1      #if     LOG_ENABLE
 129   1        mcu_uart0_timer1(115200);
 130   1      #endif
 131   1      
 132   1        while(1)
 133   1        {
 134   2        
 135   2        }
 136   1      }
 137          
 138          /*---------------------- end of file -----------------------------------------*/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    114    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
